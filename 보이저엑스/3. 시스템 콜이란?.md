

```
p.97

흔히 CPU를 컴퓨터의 두뇌라고 부르지만, CPU는 인간의 뇌처럼 스스로 생각하고 판단하는 능력을 갖추고 있찌는 못하다
이는 CPU가 빠른 속도로 처리하는 계산 능력은 가지고 있지만, 어떠한 작업을 수행해야 하는지 스스로 결정하는 능력은 갖추고 있찌 못하기 때문이다.

CPU는 매 시점 메모리의 특정 주소에 존재하는 명령을 하나씩 읽어와 그대로 실행할 뿐이다.
이 때, CPU가 수행해야 할 메모리 주소를 담고 있는 레지스터를 프로그램 카운터라고 부른다.
즉, CPU는 매번 프로그램 카운터가 가리키는 메모리 위치의 명령을 처리하게 된다.

일반적으로 조건문이나 반복문, 함수호출 등에 의한 주소 이동이 없는 이상 프로그램 카운터는 항상 바로 다음 명령을 가리키게 되어
코드의 순차적인 수행이 이루어진다.

한편 컴퓨터 시스템의 동작이 CPU에 의해서만 이루어지는 것은 아니다.
프로그램이 수행되는 중에 디스크에서 파일을 읽어오기도 하고,
키보드로부터 입력을 받거나 처리 결과를 화면에 출력하기도 한다.

이와 같이 CPU에서 명령을 수행하는 부분과, 컴퓨터 외부장치와 입출력이 이루어지는 부분을 총체적으로 이해하기 위해서는
컴퓨터 시스템의 구성에 대한 폭넓은 이해가 필요하다.

컴퓨터 시스템을 구성하는 하드웨어로는 먼저 CPU와 메모리가 있고, 이 밖에 각 입출력 장치와 이들 장치를 전담하는 작은 CPU와 메모리가 있다.
입출력 장치별로 존재하는 작은 CPU와 메모리를 각각 입출력 컨트롤러와 로컬버퍼라고 부른다.

메모리에는 사용자 프로그램들과 운영체제가 같이 올라가 수행된다.
이 때, CPU는 프로그램 카운터가 가리키는 메모리 위치의 프로그램을 수행한다.
예를 들어, 프로그램 카운터가 메모리 주소 중 운영체제가 존재하는 부분을 가리키고 있다면 현재 운영체제의 코드를 수행 중이며,
이 경우 CPU가 커널모드에서 수행 중이라고 이야기한다.

반대로 프로그램 카운터가 사용자 프로그램이 존재하는 메모리 위치를 가리키고 있다면,
그 메모리 위치에 올라가 있는 사용자 프로그램이 수행 중이며, 이 경우 사용자 모드(user mode)에서 CPU가 수행되고 있다고 이야기한다.
통상적으로 명령들은 순차적으로 수행되나, 함수호출 등으로 점프해 바로 다음 주소가 아닌 명령을 수행할 수도 있다.

CPU가 수행하는 명령에는 일반명령과 특권명령이 있다.
일반명령은 메모리에서 자료를 읽어와 CPU에서 계산하고 결과를 메모리에 쓰는 일련의 명령들을 말하는데,
이러한 일반명령은 모든 프로그램이 수행할 수 있는 명령이다.
컴퓨터 시스템에서는 이러한 특권명령을 항상 운영체제만이 수행할 수 있도록 제한하고 있다.
컴퓨터 시스템은 이 두 명령의 실행가능성을 체크하기 위해 CPU 내에 모드 비트(mode bit)를 둔다. 

사용자 프로그램이 실행되다 보면 일반명령 외에 특권명령의 수행이 필요한 경우가 있다.
예를 들어, 디스크의 파일에 접근하거나, 수행 결과를 화면에 출력하는 등의 작업은 특권 명령의 수행을 필요로 한다.
이와 같은 경우에 사용자 프로그램은 스스로 특권명령을 수행할 수 없으므로, 운영체제에게 특권명령의 대행을 요청한다.
이와 같은 서비스 요청을 시스템 콜(system call)이라고 부른다.

사용자 프로그램이 시스템 콜을 하게 되면 운영체제는 사용자 프로그램의 코드가 아닌 커널 영역에 정의된 시스템 콜 처리 코드를
수행하게 된다. 디스크에서 자료를 읽어오는 시스템 콜이라면, CPU가 디스크 컨트롤러에게 데이터를 읽어오라는 명령을 내린다.

그러면 디스크 컨트롤러는 디스크로부터 데이터를 읽어와서 자신의 로컬버퍼에 저장한다.
이 작업이 완료되면 디스크 컨트롤러가 CPU에 인터럽트를 발생시켜 입출력 작업이 완료되었음을 통지한다. 

```


```
