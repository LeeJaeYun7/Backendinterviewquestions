


```

[Real MySQL]

- 이번 장에서는 MySQL의 동시성에 영향을 미치는 잠금(Lock)과 트랜잭션, 트랜잭션의 격리 수준(Isolation Level)을 살펴보겠다.

- 트랜잭션은 작업의 완전성을 보장해 주는 것이다
-> 즉, 논리적인 작업 셋을 모두 완벽하게 처리하거나, 처리하지 못할 경우에는 원 상태로 복구해서 작업의 일부만 적용되는 현상(Partial Update)
   이 발생하지 않게 만들어주는 기능이다.

- 잠금(Lock)과 트랜잭션은 서로 비슷한 개념 같지만, 사실 잠금은 동시성을 제어하기 위한 기능이고, 트랜잭션은 데이터의 정합성을 보장하기 위한
  기능이다. 하나의 회원 정보 레코드를 여러 커넥션에서 동시에 변경하려고 하는데 잠금이 없다면, 하나의 데이터를 여러 커넥션에서
  동시에 변경할 수 있게 된다.
-> 결과적으로 해당 레코드의 값은 예측할 수 없는 상태가 된다.
-> 잠금은 여러 커넥션에서 동시에 동일한 자원(레코드나 테이블)을 요청할 경우 순서대로 한 시점에는 하나의 커넥션만
   변경할 수 있게 해주는 역할을 한다.
-> 격리 수준이라는 것은 하나의 트랜잭션 내에서 또는 여러 트랜잭션 간의 작업 내용을 어떻게 공유하고 차단할 것인지를 결정하는 레벨을 의미한다.


1) 트랜잭션
- 많은 사용자들이 데이터베이스 서버에서 트랜잭션이 개발자에게 얼마나 큰 혜택을 제공하는지를 자주 잊어버리는 것 같다.
-> 지금은 많이 달라졌지만, 여전히 MySQL 서버에서는 MyISAM이나 MEMORY 스토리지 엔진이 더 빠르다고 생각하고,
   InnoDB 스토리지 엔진은 사용하기 복잡하고 번거롭다고 생각하곤 한다.
-> 하지만 사실은 MyISAM이나 MEMORY 같이 트랜잭션을 지원하지 않는 스토리지 엔진의 테이블이 더 많은 고민거리를 만들어낸다.

- 이번 절에서는 트랜잭션을 지원하지 않는 MyISAM과 트랜잭션을 지원하는 InnoDB의 처리 방식 차이를 잠깐 살펴보고자 한다.
-> 그리고 트랜잭션을 사용할 경우 주의할 사항도 함께 살펴보겠다.

1-1) MySQL에서의 트랜잭션
- 트랜잭션은 꼭 여러 개의 변경 작업을 수행하는 쿼리가 조합됐을 때만, 의미 있는 개념은 아니다.
-> 트랜잭션은 하나의 논리적인 작업 셋에 하나의 쿼리가 있든 두 개 이상의 쿼리가 있든 관계없이
   논리적인 작업 셋 자체가 100% 적용되거나(COMMIT을 실행했을 때) 아무것도 적용되지 않아야(ROLLBACK 또는 트랜잭션을 ROLLBACK시키는 오류가 발생했을 때)
   함을 보장해 주는 것이다.

- 간단한 예제로 트랜잭션 관점에서 InnoDB 테이블과 MyISAM 테이블의 차이를 살펴보자.
-> 위와 같이 테스트용 테이블에 각각 레코드를 1건씩 저장한 후, AUTO-COMMIT 모드에서 다음 쿼리 문장을 InnoDB 테이블과 MyISAM 테이블에서 각각 실행해보자.
-> 두 개의 스토리지 엔진에서 겨로가가 어떻게 다를까? 위 쿼리 문장의 테스트 결과는 다음과 같다.

 




```
